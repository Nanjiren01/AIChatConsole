(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-974aed22"],{5662:function(e,t,a){"use strict";a("da5e")},5809:function(e,t,a){"use strict";a("df40")},"618b":function(e,t,a){},"757a":function(e,t,a){"use strict";a("618b")},b7a3:function(e,t,a){"use strict";a.r(t);var l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"page-container"},[a("ai-table",{attrs:{"table-actions":e.tableActions,"table-columns":e.tableColumns,"table-data":e.tableData,"table-action-column":e.tableActionColumn,pagination:e.pagination},on:{refresh:e.handleRefresh},scopedSlots:e._u([{key:"topActions",fn:function(){return[a("el-button",{attrs:{type:"primary",icon:"el-icon-plus"},on:{click:e.handleCreate}},[e._v("新建")])]},proxy:!0},{key:"rowActions",fn:function(t){return[a("el-button",{attrs:{icon:"el-icon-edit"},on:{click:function(a){return a.stopPropagation(),e.handleEdit(t.row)}}},[e._v("编辑")]),a("el-button",{attrs:{icon:"el-icon-delete",disabled:""},on:{click:function(a){return a.stopPropagation(),e.handleDelete(t.row)}}},[e._v("删除")])]}},{key:"state",fn:function(t){return[1==t.row.state?a("el-tag",{attrs:{type:"success"}},[e._v("正常")]):a("el-tag",{attrs:{type:"danger"}},[e._v("停用")]),a("el-button",{staticStyle:{"margin-left":"10px"},attrs:{icon:"el-icon-disabled"},on:{click:function(a){return a.stopPropagation(),e.toggleEnable(t.row)}}},[e._v(" "+e._s(1==t.row.state?"禁用":"启用")+" ")])]}},{key:"platformName",fn:function(t){return[a("el-tag",[e._v(e._s(t.row.platformName))])]}},{key:"header",fn:function(){return[a("div",{staticStyle:{margin:"5px 0"}},[a("el-alert",{attrs:{title:"只有处于启用状态的key才会被使用",type:"info",closable:!1}})],1)]},proxy:!0}])}),e.editShow?a("api-key-edit",{attrs:{"api-key":e.edit},on:{close:e.handleCloseEditDialog,created:e.handleCreated}}):e._e()],1)},o=[],n=a("c7eb"),i=a("1da1"),r=(a("d81d"),a("f4f7")),s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-dialog",{directives:[{name:"el-drag-dialog",rawName:"v-el-drag-dialog"}],attrs:{visible:e.dialogTableVisible,title:e.title,width:"70%"},on:{"update:visible":function(t){e.dialogTableVisible=t},dragDialog:e.handleDrag,close:e.handleClose}},[a("el-form",{ref:"form",attrs:{model:e.model,"label-width":"80px"}},[a("el-form-item",{attrs:{label:"平台"}},[a("el-select",{attrs:{disabled:""},model:{value:e.model.platformId,callback:function(t){e.$set(e.model,"platformId",t)},expression:"model.platformId"}},[a("el-option",{attrs:{label:"OpenAI",value:1}})],1)],1),a("el-form-item",{attrs:{label:"API KEY"}},[a("el-input",{model:{value:e.model.key,callback:function(t){e.$set(e.model,"key",t)},expression:"model.key"}})],1),e.model.id?[a("el-form-item",{attrs:{label:"状态"}},[a("el-radio-group",{attrs:{disabled:""},model:{value:e.model.state,callback:function(t){e.$set(e.model,"state",t)},expression:"model.state"}},[a("el-radio",{attrs:{label:1}},[e._v("启用")]),a("el-radio",{attrs:{label:2}},[e._v("停用")]),a("el-radio",{attrs:{label:3}},[e._v("初始")]),a("el-radio",{attrs:{label:4}},[e._v("额度查询中")]),a("el-radio",{attrs:{label:5}},[e._v("key被禁用")]),a("el-radio",{attrs:{label:6}},[e._v("key不合法")])],1)],1),a("el-form-item",{attrs:{label:"创建者"}},[a("el-input",{attrs:{disabled:""},model:{value:e.model.creatorName,callback:function(t){e.$set(e.model,"creatorName",t)},expression:"model.creatorName"}})],1),a("el-form-item",{attrs:{label:"创建时间"}},[a("el-input",{attrs:{disabled:""},model:{value:e.model.createTime,callback:function(t){e.$set(e.model,"createTime",t)},expression:"model.createTime"}})],1)]:e._e(),[a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:e.handleSubmit}},[e._v("提交")])],1)]],2)],1)],1)},c=[],d=(a("caad"),a("2532"),a("ac1f"),a("5319"),a("99af"),{bind:function(e,t,a){var l=e.querySelector(".el-dialog__header"),o=e.querySelector(".el-dialog");l.style.cssText+=";cursor:move;",o.style.cssText+=";top:0px;";var n=function(){return window.document.currentStyle?function(e,t){return e.currentStyle[t]}:function(e,t){return getComputedStyle(e,!1)[t]}}();l.onmousedown=function(e){var t=e.clientX-l.offsetLeft,i=e.clientY-l.offsetTop,r=o.offsetWidth,s=o.offsetHeight,c=document.body.clientWidth,d=document.body.clientHeight,u=o.offsetLeft,p=c-o.offsetLeft-r,m=o.offsetTop,f=d-o.offsetTop-s,h=n(o,"left"),b=n(o,"top");h.includes("%")?(h=+document.body.clientWidth*(+h.replace(/\%/g,"")/100),b=+document.body.clientHeight*(+b.replace(/\%/g,"")/100)):(h=+h.replace(/\px/g,""),b=+b.replace(/\px/g,"")),document.onmousemove=function(e){var l=e.clientX-t,n=e.clientY-i;-l>u?l=-u:l>p&&(l=p),-n>m?n=-m:n>f&&(n=f),o.style.cssText+=";left:".concat(l+h,"px;top:").concat(n+b,"px;"),a.child.$emit("dragDialog")},document.onmouseup=function(e){document.onmousemove=null,document.onmouseup=null}}}}),u=function(e){e.directive("el-drag-dialog",d)};window.Vue&&(window["el-drag-dialog"]=d,Vue.use(u)),d.install=u;var p=d,m=a("b775");function f(e){return Object(m["a"])({url:"/apiKeys",method:"get",params:e})}function h(e,t,a,l){return Object(m["a"])({url:"/apiKeys",method:"post",data:{id:e,key:t,state:a,platformId:l}})}var b={name:"ApiKeyEdit",directives:{elDragDialog:p},props:{apiKey:{type:Object,default:function(){}}},data:function(){return{dialogTableVisible:!0,model:{id:null,platformId:null,key:null,state:null,creatorName:null,createTime:null}}},computed:{title:function(){return this.model.id?"API KEY编辑":"API KEY添加"}},created:function(){this.model.id=this.apiKey&&this.apiKey.id||0,this.model.platformId=this.apiKey&&this.apiKey.platformId||0,this.model.state=this.apiKey&&this.apiKey.state||1,this.model.key=this.apiKey&&this.apiKey.key||"",this.model.creatorName=this.apiKey&&this.apiKey.creatorName||"",this.model.createTime=this.apiKey&&this.apiKey.createTime||""},methods:{handleDrag:function(){},handleClose:function(){this.$emit("close")},handleSubmit:function(){var e=this;h(this.model.id,this.model.key,this.model.state,this.model.platformId).then((function(t){e.$message.success(e.model.id?"修改成功！":"添加成功！"),e.$emit("created")}))}}},g=b,y=a("2877"),w=Object(y["a"])(g,s,c,!1,null,null,null),v=w.exports,k={name:"UserIndex",components:{AiTable:r["a"],ApiKeyEdit:v},data:function(){return{tableActions:[],tableColumns:[{label:"#",prop:"id",width:55},{label:"平台",prop:"platformName",slot:"platformName",width:120},{label:"api key",prop:"key"},{label:"使用次数",prop:"callCount",width:80},{label:"状态",prop:"state",slot:"state",width:150},{label:"创建人",prop:"creatorName",width:150},{label:"创建时间",prop:"createTime",width:140}],tableActionColumn:{width:260},tableData:[],pagination:{total:0,showDetail:!1},editShow:!1,edit:{id:0}}},computed:{},mounted:function(){this.reload()},methods:{reload:function(){var e=this;f().then((function(t){console.log("resp",t);var a=t.data||[];e.tableData=a.map((function(e){return{id:e.id,platformId:e.platformId,platformName:e.platformName,key:e.key,models:e.models,quota:e.quota,callCount:e.callCount,state:e.state,creatorName:e.creatorName,createTime:e.createTime,updateTime:e.updateTime}})),e.pagination.total=e.tableData.length}))},handleRefresh:function(){this.reload()},handleCreate:function(){this.editShow=!0,this.edit.id=0,this.edit.platformId=1,this.edit.key=null,this.edit.state=null,this.edit.creatorName=null,this.edit.createTime=null},handleEdit:function(e){this.editShow=!0,this.edit.id=e.id,this.edit.platformId=e.platformId,this.edit.key=e.key,this.edit.state=e.state,this.edit.creatorName=e.creatorName,this.edit.createTime=e.createTime},handleDelete:function(e){console.log("delete",e)},toggleEnable:function(e){var t=this;this.$confirm("确定"+(1===e.state?"停用":"启用")+e.key+"？","警告",{confirmButtonText:"确定",cancelButtonText:"取消",customClass:"long-message",width:"600px",type:"warning"}).then(Object(i["a"])(Object(n["a"])().mark((function a(){var l;return Object(n["a"])().wrap((function(a){while(1)switch(a.prev=a.next){case 0:l=1===e.state?2:1,h(e.id,e.key,l,e.platformId).then((function(e){console.log("resp",e),t.$message.success("操作成功！"),t.reload()}));case 2:case"end":return a.stop()}}),a)}))))},getStateName:function(e){return{1:"启用",2:"停用"}[e]||"未知"},handleCloseEditDialog:function(){this.editShow=!1},handleCreated:function(){this.editShow=!1,this.reload()}}},C=k,_=(a("5662"),a("5809"),Object(y["a"])(C,l,o,!1,null,"3d02bc20",null));t["default"]=_.exports},da5e:function(e,t,a){},df40:function(e,t,a){},f4f7:function(e,t,a){"use strict";var l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"comp-container"},[a("div",{staticClass:"filter-container"},[e._t("filter")],2),a("div",{staticClass:"table-container",staticStyle:{padding:"20px"}},[a("div",{staticClass:"operation-container",staticStyle:{"margin-bottom":"10px","padding-left":"10px"}},[a("el-button",{attrs:{icon:"el-icon-refresh",circle:""},on:{click:e.handleClickRefreshButton}}),e._t("topActions")],2),e._t("header"),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:e.tableData,border:"",stripe:""},on:{"row-click":e.handleRowClick,"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"55"}}),e._t("leftColumns"),e._l(e.tableColumns,(function(t){return a("el-table-column",{key:t.prop,attrs:{prop:t.prop,label:t.label,width:t.width,type:t.type,"show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(a){return e._t(t.slot,[e._v(" "+e._s(a.row[t.prop])+" ")],{row:a.row})}}],null,!0)})})),e._t("columns"),e.tableActions?a("el-table-column",{attrs:{label:"操作",width:e.tableActionColumn?e.tableActionColumn.width:0},scopedSlots:e._u([{key:"default",fn:function(t){return e._t("rowActions",null,{row:t.row})}}],null,!0)},e._l(e.tableActions,(function(t){return a("el-button",{key:t.key,attrs:{type:t.type}},[e._v(" "+e._s(t.label)+" ")])})),1):e._e()],2),a("el-pagination",{staticStyle:{"margin-top":"10px"},attrs:{"current-page":e.pagination.pageNum,"page-sizes":[20,200,500],"page-size":e.pagination.pageSize,layout:e.paginationLayout,total:e.pagination.total||0},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],2)])},o=[],n={name:"AiTable",components:{},props:{tableActions:{type:[Array,Boolean],default:function(){return[]}},tableColumns:{type:Array,default:function(){return[]}},tableActionColumn:{type:Object,default:function(){}},tableData:{type:Array,default:function(){return[]}},pagination:{type:Object,default:function(){}},loading:{type:Boolean,default:!1}},data:function(){return{currentPage:1}},computed:{paginationLayout:function(){if(!this.pagination)return"";var e=this.pagination.showDetail;return!1===e?"total":"total, sizes, prev, pager, next, jumper"}},created:function(){},methods:{handleSizeChange:function(e){this.$emit("pageSizeChanged",e)},handleCurrentChange:function(e){this.$emit("pageCurrentChanged",e)},handleRowClick:function(e){this.$refs.multipleTable.toggleRowSelection(e)},handleSelectionChange:function(){},handleClickRefreshButton:function(){this.$emit("refresh")}}},i=n,r=(a("757a"),a("2877")),s=Object(r["a"])(i,l,o,!1,null,"61d77082",null);t["a"]=s.exports}}]);