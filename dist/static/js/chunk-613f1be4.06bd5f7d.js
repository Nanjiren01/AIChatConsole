(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-613f1be4"],{"40f5":function(t,e,a){"use strict";a("e258")},"4ca9":function(t,e,a){"use strict";a("96df")},5209:function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"page-container"},[a("ai-table",{attrs:{"table-actions":t.tableActions,"table-columns":t.tableColumns,"table-data":t.tableData,"table-action-column":t.tableActionColumn,pagination:t.pagination},on:{refresh:t.handleRefresh},scopedSlots:t._u([{key:"topActions",fn:function(){return[a("el-button",{attrs:{type:"primary",icon:"el-icon-plus"},on:{click:t.handleCreate}},[t._v("新建")])]},proxy:!0},{key:"rowActions",fn:function(e){return[a("el-button",{attrs:{icon:"el-icon-edit"},on:{click:function(a){return a.stopPropagation(),t.handleEdit(e.row)}}},[t._v("编辑")])]}},{key:"formattedTitle",fn:function(e){return[e.row.formatted?a("i",{staticClass:"el-icon-orange"}):t._e(),t._v(" "+t._s(e.row.formattedTitle)+" ")]}},{key:"tokens",fn:function(e){return[-1==e.row.tokens?a("el-tag",{attrs:{type:"success"}},[t._v("无限制")]):0===e.row.tokens?a("el-tag",{attrs:{type:"danger"}},[t._v(t._s(e.row.tokens))]):e.row.tokens<50?a("el-tag",{attrs:{type:"warning"}},[t._v(t._s(e.row.tokens))]):a("el-tag",{attrs:{type:"success"}},[t._v(t._s(e.row.tokens))])]}},{key:"chatCount",fn:function(e){return[-1==e.row.chatCount?a("el-tag",{attrs:{type:"success"}},[t._v("无限制")]):0===e.row.chatCount?a("el-tag",{attrs:{type:"danger"}},[t._v(t._s(e.row.chatCount))]):e.row.chatCount<5?a("el-tag",{attrs:{type:"warning"}},[t._v(t._s(e.row.chatCount))]):a("el-tag",{attrs:{type:"success"}},[t._v(t._s(e.row.chatCount))])]}},{key:"advancedChatCount",fn:function(e){return[-1==e.row.advancedChatCount?a("el-tag",{attrs:{type:"success"}},[t._v("无限制")]):0===e.row.advancedChatCount?a("el-tag",{attrs:{type:"danger"}},[t._v(t._s(e.row.advancedChatCount))]):e.row.advancedChatCount<5?a("el-tag",{attrs:{type:"warning"}},[t._v(t._s(e.row.advancedChatCount))]):a("el-tag",{attrs:{type:"success"}},[t._v(t._s(e.row.advancedChatCount))])]}},{key:"drawCount",fn:function(e){return[-1===e.row.drawCount?a("el-tag",{attrs:{type:"success"}},[t._v("无限制")]):0===e.row.drawCount?a("el-tag",{attrs:{type:"danger"}},[t._v(t._s(e.row.drawCount))]):e.row.drawCount<5?a("el-tag",{attrs:{type:"warning"}},[t._v(t._s(e.row.drawCount))]):a("el-tag",{attrs:{type:"success"}},[t._v(t._s(e.row.drawCount))])]}},{key:"state",fn:function(e){return[10==e.row.state?a("el-tag",{attrs:{type:"success"}},[t._v("上架")]):20==e.row.state?a("el-tag",{attrs:{type:"warning"}},[t._v("下架")]):0==e.row.state?a("el-tag",{attrs:{type:"primary"}},[t._v("草稿")]):30==e.row.state?a("el-tag",{attrs:{type:"info"}},[t._v("删除")]):t._e()]}},{key:"calcType",fn:function(e){return[0==e.row.calcTypeId?a("el-tag",[t._v("未设置")]):1==e.row.calcTypeId?a("el-tag",[t._v("总额")]):2==e.row.calcTypeId?a("el-tag",[t._v("按天")]):3==e.row.calcTypeId?a("el-tag",[t._v("按小时")]):4==e.row.calcTypeId?a("el-tag",[t._v("按3小时")]):a("el-tag",[t._v("未知")])]}}])}),a("detail",{ref:"detail",attrs:{show:t.showDetail,"package-entity":t.detailModel},on:{changed:t.handleChanged,close:t.handleCloseDetail}})],1)},i=[],l=(a("d81d"),a("ac1f"),a("5319"),a("4de4"),a("d3b7"),a("f4f7")),o=a("a1f4"),c=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-drawer",{staticStyle:{height:"100%"},attrs:{title:t.title,size:"60%",visible:t.show,"modal-append-to-body":!0,"before-close":t.handleClose}},[a("div",{staticStyle:{padding:"20px","overflow-y":"auto"}},[a("el-form",{ref:"form",staticStyle:{"padding-right":"180px"},attrs:{"label-width":"220px"}},[t.packageEntity.uuid?a("el-form-item",{attrs:{label:"uuid"}},[a("el-input",{attrs:{disabled:""},model:{value:t.packageEntity.uuid,callback:function(e){t.$set(t.packageEntity,"uuid",e)},expression:"packageEntity.uuid"}})],1):t._e(),a("el-form-item",{attrs:{label:"标题"}},[a("el-input",{attrs:{type:"textarea",autosize:"",disabled:t.disabled},model:{value:t.packageEntity.title,callback:function(e){t.$set(t.packageEntity,"title",e)},expression:"packageEntity.title"}})],1),a("el-form-item",{attrs:{label:"副标题"}},[a("el-input",{attrs:{type:"textarea",autosize:"",placeholder:t.defaultSubTitle,disabled:t.disabled},model:{value:t.packageEntity.subTitle,callback:function(e){t.$set(t.packageEntity,"subTitle",e)},expression:"packageEntity.subTitle"}})],1),a("el-form-item",{attrs:{label:"类型"}},[a("el-select",{attrs:{disabled:t.disabled},model:{value:t.packageEntity.calcTypeId,callback:function(e){t.$set(t.packageEntity,"calcTypeId",e)},expression:"packageEntity.calcTypeId"}},[a("el-option",{attrs:{label:"总额",value:1}}),a("el-option",{attrs:{label:"每天",value:2}}),a("el-option",{attrs:{label:"每小时",value:3}}),a("el-option",{attrs:{label:"每3小时",value:4}})],1)],1),a("el-form-item",{attrs:{label:"状态"}},[a("span",{staticStyle:{"margin-right":"10px"}},[10==t.packageEntity.state?a("el-tag",{attrs:{type:"success"}},[t._v("上架")]):t.packageEntity.id&&0!=t.packageEntity.state?20==t.packageEntity.state?a("el-tag",{attrs:{type:"warning"}},[t._v("下架")]):30==t.packageEntity.state?a("el-tag",{attrs:{type:"info"}},[t._v("已删除")]):t._e():a("el-tag",{attrs:{type:"primary"}},[t._v("草稿")])],1),t.packageEntity.id&&[0,10,20].includes(t.packageEntity.state)?a("el-button",{attrs:{type:"primary"},on:{click:function(e){return e.stopPropagation(),t.handleToggleEnable()}}},[t._v(" "+t._s(10==t.packageEntity.state?"下架":"上架")+" ")]):t._e()],1),a("el-form-item",{attrs:{label:"tokens"}},[a("el-input-number",{attrs:{disabled:t.disabled},model:{value:t.packageEntity.tokens,callback:function(e){t.$set(t.packageEntity,"tokens",e)},expression:"packageEntity.tokens"}})],1),a("el-form-item",{attrs:{label:"普通聊天次数（GPT3.5）"}},[a("el-input-number",{attrs:{disabled:t.disabled},model:{value:t.packageEntity.chatCount,callback:function(e){t.$set(t.packageEntity,"chatCount",e)},expression:"packageEntity.chatCount"}})],1),a("el-form-item",{attrs:{label:"高级聊天次数（GPT4）"}},[a("el-input-number",{attrs:{disabled:t.disabled},model:{value:t.packageEntity.advancedChatCount,callback:function(e){t.$set(t.packageEntity,"advancedChatCount",e)},expression:"packageEntity.advancedChatCount"}})],1),a("el-form-item",{attrs:{label:"绘图次数"}},[a("el-input-number",{attrs:{disabled:t.disabled},model:{value:t.packageEntity.drawCount,callback:function(e){t.$set(t.packageEntity,"drawCount",e)},expression:"packageEntity.drawCount"}})],1),a("el-form-item",{attrs:{label:"天数"}},[a("el-input-number",{attrs:{disabled:t.disabled},model:{value:t.packageEntity.days,callback:function(e){t.$set(t.packageEntity,"days",e)},expression:"packageEntity.days"}})],1),a("el-form-item",{attrs:{label:"价格（元）"}},[a("el-input",{attrs:{disabled:t.disabled},model:{value:t.packageEntity.price,callback:function(e){t.$set(t.packageEntity,"price",e)},expression:"packageEntity.price"}})],1),a("el-form-item",[10===t.packageEntity.state?a("el-alert",{attrs:{title:"请先下架",type:"info",closable:!1}}):t._e(),a("el-button",{attrs:{type:"primary",disabled:t.disabled},on:{click:t.handleSubmit}},[t._v(" "+t._s(t.loading?"操作中……":t.packageEntity.id?"保存":"创建")+" ")])],1)],1),a("el-form",[a("div",{staticStyle:{"margin-bottom":"100px"}},[a("el-alert",{staticStyle:{"margin-bottom":"5px"},attrs:{title:"以上所有次数（及tokens）均表示每天的次数。每天剩余使用次数将被清零，不结转至下一个自然日。",type:"info",closable:!1}}),a("el-alert",{attrs:{title:"天数是指，用户从购买之日起算，截止设定的天数前可用，过期自动失效。建议月卡设定天数为31天，年卡设定天数为366天。",type:"info",closable:!1}})],1),t.packageEntity.id?a("el-form-item",[a("el-button",{attrs:{type:"danger"},on:{click:t.handleDelete}},[t._v(" 删除 ")])],1):t._e()],1)],1)])},s=[],r=a("c7eb"),u=a("1da1"),d=(a("99af"),a("a15b"),{name:"PackageDetail",components:{},props:{show:{type:Boolean,default:!1},packageEntity:{type:Object,default:function(){return[]}}},data:function(){return{loading:!1,drawer:!0}},computed:{title:function(){return this.packageEntity.title+"详情"},defaultSubTitle:function(){if(!this.packageEntity.calcTypeId)return"";var t=[],e={1:"",2:"每天",3:"每小时",4:"每3小时"}[this.packageEntity.calcTypeId];return this.packageEntity.tokens&&t.push("".concat(e," ").concat(this.packageEntity.tokens," token")),this.packageEntity.chatCount&&t.push("".concat(e," ").concat(this.packageEntity.chatCount," 次普通聊天（GPT3.5）")),this.packageEntity.advancedChatCount&&t.push("".concat(e," ").concat(this.packageEntity.advancedChatCount," 次高级聊天（GPT4）")),this.packageEntity.drawCount&&t.push("".concat(e," ").concat(this.packageEntity.drawCount," 次AI绘画")),this.packageEntity.days&&t.push("有效期：".concat(this.packageEntity.days,"天")),t.join("，")},disabled:function(){return this.loading||10===this.packageEntity.state}},mounted:function(){},methods:{reload:function(){this.packageEntity.id},handleClose:function(){this.$emit("close")},handleRefresh:function(){this.reload()},handleSubmit:function(){var t=this;if(this.packageEntity.title)if(this.packageEntity.calcTypeId)if(this.packageEntity.days<=0)this.$message.error("天数必须是正数！");else if(this.packageEntity.price)if(this.packageEntity.id){if(10===this.packageEntity.state)return void this.$message.error("请先下架！");this.loading=!0,Object(o["f"])(this.packageEntity).then((function(e){t.$message.success("操作成功！"),t.$emit("changed",t.packageEntity.id)})).finally((function(){t.loading=!1}))}else this.loading=!0,Object(o["a"])({title:this.packageEntity.title,subTitle:this.packageEntity.subTitle,tokens:this.packageEntity.tokens,chatCount:this.packageEntity.chatCount,advancedChatCount:this.packageEntity.advancedChatCount,drawCount:this.packageEntity.drawCount,days:this.packageEntity.days,price:this.packageEntity.price,calcTypeId:this.packageEntity.calcTypeId}).then((function(e){t.$message.success("创建成功！"),t.$emit("changed",e.data.id)})).finally((function(){t.loading=!1}));else this.$message.error("价格不能为空！");else this.$message.error("请选择类型");else this.$message.error("标题不能为空！")},handleToggleEnable:function(){var t=this,e=this.packageEntity;if(0===e.state||20===e.state){if(!e.title)return void this.$message.error("请输入标题！");if(!e.calcTypeId)return void this.$message.error("请选择类型");if(!e.price)return void this.$message.error("请输入价格")}this.$confirm(10===e.state?"下架后用户将无法购买此套餐，确定下架"+e.title+"吗？":"上架后套餐信息无法修改，确定上架"+e.title+"吗？","操作确认",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(Object(u["a"])(Object(r["a"])().mark((function a(){return Object(r["a"])().wrap((function(a){while(1)switch(a.prev=a.next){case 0:10===e.state?Object(o["d"])(e.uuid).then((function(){t.$message.success("操作成功！"),t.$emit("changed",e.id)})):Object(o["e"])(e.uuid).then((function(){t.$message.success("操作成功！"),t.$emit("changed",e.id)}));case 1:case"end":return a.stop()}}),a)}))))},handleDelete:function(){var t=this,e=this.packageEntity;this.$confirm("确定删除"+e.title+"吗？","删除确认",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(Object(u["a"])(Object(r["a"])().mark((function a(){return Object(r["a"])().wrap((function(a){while(1)switch(a.prev=a.next){case 0:Object(o["b"])(e.uuid).then((function(){t.$message.success("操作成功！"),t.$emit("changed"),t.$emit("close")}));case 1:case"end":return a.stop()}}),a)}))))}}}),p=d,h=(a("40f5"),a("2877")),g=Object(h["a"])(p,c,s,!1,null,"939a50b8",null),y=g.exports,f={name:"PackageIndex",components:{AiTable:l["a"],Detail:y},data:function(){return{showDetail:!1,tableActions:[{key:"detail",label:"详情",type:"primary"}],tableColumns:[{label:"#",prop:"id",width:55},{label:"uuid",prop:"uuid",width:260},{label:"标题",slot:"formattedTitle"},{label:"价格",prop:"price",width:75},{label:"类型",slot:"calcType",width:100},{label:"状态",prop:"state",slot:"state",width:60},{label:"tokens",prop:"tokens",slot:"tokens",width:70},{label:"普通聊天次数",prop:"chatCount",slot:"chatCount",width:95},{label:"高级聊天次数",prop:"advancedChatCount",slot:"advancedChatCount",width:95},{label:"绘画次数",prop:"drawCount",slot:"drawCount",width:70},{label:"天数",prop:"days",width:75},{label:"创建时间",prop:"createTime",width:140},{label:"更新时间",prop:"updateTime",width:140}],tableActionColumn:{width:100},tableData:[],pagination:{total:0,showDetail:!1},detailModel:{id:null,uuid:null,title:null,subTitle:null,state:null,top:null,tokens:null,days:null,price:null,calcTypeId:null,calcType:null,chatCount:null,advancedChatCount:null,drawCount:null,createTime:null,updateTime:null}}},computed:{},created:function(){},mounted:function(){this.reload()},methods:{reload:function(){var t=this;Object(o["c"])().then((function(e){var a=e.data||[];t.tableData=a.map((function(t){var e=t.title?t.title.replace(/(<([^>]+)>)/gi,""):t.title;return{id:t.id,uuid:t.uuid,title:t.title,formattedTitle:e,formatted:t.title!==e,subTitle:t.subTitle,state:t.state,top:t.top,tokens:t.tokens,days:t.days,price:t.price,calcType:t.calcType,calcTypeId:t.calcTypeId,chatCount:t.chatCount,advancedChatCount:t.advancedChatCount,drawCount:t.drawCount,createTime:t.createTime,updateTime:t.updateTime}})),t.pagination.total=t.tableData.length})).then((function(){if(console.log("this.showDetail",t.showDetail),t.showDetail){var e=t.tableData.filter((function(e){return e.id===t.detailModel.id}))[0];console.log("row",e),e&&t.updateDetail(e)}}))},updateDetail:function(t){var e=this;this.detailModel.id=t.id,this.detailModel.uuid=t.uuid,this.detailModel.title=t.title,this.detailModel.subTitle=t.subTitle,this.detailModel.top=t.top,this.detailModel.state=t.state,this.detailModel.tokens=t.tokens,this.detailModel.days=t.days,this.detailModel.price=t.price,this.detailModel.calcType=t.calcType,this.detailModel.calcTypeId=t.calcTypeId,this.detailModel.chatCount=t.chatCount,this.detailModel.advancedChatCount=t.advancedChatCount,this.detailModel.drawCount=t.drawCount,this.detailModel.createTime=t.createTime,this.detailModel.updateTime=t.updateTime,this.$nextTick((function(){e.$refs.detail.reload()}))},handleRefresh:function(){this.reload()},handleCreate:function(){this.showDetail=!0,this.updateDetail({id:null,uuid:"",title:"",subTitle:"",top:0,state:0,days:0,price:null,calcType:null,calcTypeId:null,tokens:0,chatCount:0,advancedChatCount:0,drawCount:0,createTime:null,updateTime:null})},handleEdit:function(t){this.showDetail=!0,this.updateDetail(t)},handleCloseDetail:function(){this.showDetail=!1},handleChanged:function(t){this.detailModel.id=t,this.reload()}}},b=f,m=(a("4ca9"),Object(h["a"])(b,n,i,!1,null,"5135bc5a",null));e["default"]=m.exports},"618b":function(t,e,a){},"757a":function(t,e,a){"use strict";a("618b")},"96df":function(t,e,a){},a1f4:function(t,e,a){"use strict";a.d(e,"c",(function(){return i})),a.d(e,"a",(function(){return l})),a.d(e,"f",(function(){return o})),a.d(e,"e",(function(){return c})),a.d(e,"d",(function(){return s})),a.d(e,"b",(function(){return r}));var n=a("b775");function i(){return Object(n["a"])({url:"/package/all",method:"get"})}function l(t){return Object(n["a"])({url:"/package",method:"post",data:t})}function o(t){return Object(n["a"])({url:"/package",method:"put",data:t})}function c(t){return Object(n["a"])({url:"/package/".concat(t,"/onSales"),method:"put"})}function s(t){return Object(n["a"])({url:"/package/".concat(t,"/offShelves"),method:"put"})}function r(t){return Object(n["a"])({url:"/package/".concat(t),method:"delete"})}},e258:function(t,e,a){},f4f7:function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"comp-container"},[a("div",{staticClass:"filter-container"},[t._t("filter")],2),a("div",{staticClass:"table-container",staticStyle:{padding:"20px"}},[a("div",{staticClass:"operation-container",staticStyle:{"margin-bottom":"10px","padding-left":"10px"}},[a("el-button",{attrs:{icon:"el-icon-refresh",circle:""},on:{click:t.handleClickRefreshButton}}),t._t("topActions")],2),t._t("header"),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:t.tableData,border:"",stripe:""},on:{"row-click":t.handleRowClick,"selection-change":t.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"55"}}),t._t("leftColumns"),t._l(t.tableColumns,(function(e){return a("el-table-column",{key:e.prop,attrs:{prop:e.prop,label:e.label,width:e.width,type:e.type,"show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(a){return t._t(e.slot,[t._v(" "+t._s(a.row[e.prop])+" ")],{row:a.row})}}],null,!0)})})),t._t("columns"),t.tableActions?a("el-table-column",{attrs:{label:"操作",width:t.tableActionColumn?t.tableActionColumn.width:0},scopedSlots:t._u([{key:"default",fn:function(e){return t._t("rowActions",null,{row:e.row})}}],null,!0)},t._l(t.tableActions,(function(e){return a("el-button",{key:e.key,attrs:{type:e.type}},[t._v(" "+t._s(e.label)+" ")])})),1):t._e()],2),a("el-pagination",{staticStyle:{"margin-top":"10px"},attrs:{"current-page":t.pagination.pageNum,"page-sizes":[20,200,500],"page-size":t.pagination.pageSize,layout:t.paginationLayout,total:t.pagination.total||0},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],2)])},i=[],l={name:"AiTable",components:{},props:{tableActions:{type:[Array,Boolean],default:function(){return[]}},tableColumns:{type:Array,default:function(){return[]}},tableActionColumn:{type:Object,default:function(){}},tableData:{type:Array,default:function(){return[]}},pagination:{type:Object,default:function(){}},loading:{type:Boolean,default:!1}},data:function(){return{currentPage:1}},computed:{paginationLayout:function(){if(!this.pagination)return"";var t=this.pagination.showDetail;return!1===t?"total":"total, sizes, prev, pager, next, jumper"}},created:function(){},methods:{handleSizeChange:function(t){this.$emit("pageSizeChanged",t)},handleCurrentChange:function(t){this.$emit("pageCurrentChanged",t)},handleRowClick:function(t){this.$refs.multipleTable.toggleRowSelection(t)},handleSelectionChange:function(){},handleClickRefreshButton:function(){this.$emit("refresh")}}},o=l,c=(a("757a"),a("2877")),s=Object(c["a"])(o,n,i,!1,null,"61d77082",null);e["a"]=s.exports}}]);